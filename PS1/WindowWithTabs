Add-Type -AssemblyName PresentationFramework

# Array of strings for the sidebar items
$sideBarItems = @(
    "Sidebar Item 1",
    "Sidebar Item 2",
    "Sidebar Item 3"
)

# Array of strings for the tabs
$tabItems = @(
    "Tab 1",
    "Tab 2",
    "Tab 3"
)

# Create the main window
$mainWindow = New-Object System.Windows.Window
$mainWindow.Title = "Sidebar Tabs Demo"
$mainWindow.Width = 800
$mainWindow.Height = 600

# Create the main panel
$mainPanel = New-Object System.Windows.Controls.DockPanel

# Create the sidebar
$sidebar = New-Object System.Windows.Controls.ListBox
$sidebar.Width = 200
$sidebar.ItemsSource = $sideBarItems

# Create a tab control for displaying the content
$tabControl = New-Object System.Windows.Controls.TabControl

# Add the sidebar and tab control to the main panel
[System.Windows.Controls.DockPanel]::SetDock($sidebar, "Left")
[System.Windows.Controls.DockPanel]::SetDock($tabControl, "Right")
$mainPanel.Children.Add($sidebar)
$mainPanel.Children.Add($tabControl)

# Add some sample tabs to the tab control
foreach ($tabItemText in $tabItems) {
    $tabItem = New-Object System.Windows.Controls.TabItem
    $tabItem.Header = $tabItemText
    $tabControl.Items.Add($tabItem)

    $tabContent = New-Object System.Windows.Controls.TextBlock
    $tabContent.Text = "This is the content of $tabItemText"
    $tabItem.Content = $tabContent
}

# Register the event handler for the selection changed event of the sidebar
$sidebar.Add_SelectionChanged({
    $selectedSidebarItem = $sideBarItems[$sidebar.SelectedIndex]
    $tabControl.SelectedIndex = 0 # Set the first tab as active
})

# Set the main panel as the content of the main window
$mainWindow.Content = $mainPanel

# Show the main window
$mainWindow.ShowDialog()
