Sub ReadOutlookInbox()
    Dim OutlookApp As Object
    Dim OutlookNamespace As Object
    Dim OutlookFolder As Object
    Dim OutlookItem As Object
    
    ' Create an Outlook application instance
    Set OutlookApp = CreateObject("Outlook.Application")
    
    ' Get the MAPI namespace
    Set OutlookNamespace = OutlookApp.GetNamespace("MAPI")
    
    ' Get the inbox folder
    Set OutlookFolder = OutlookNamespace.GetDefaultFolder(6) ' 6 corresponds to the inbox folder
    
    ' Loop through the items in the inbox
    For Each OutlookItem In OutlookFolder.Items
        ' Here you can access and manipulate each email (OutlookItem)
        ' For example, you can read the subject and body of the email:
        Debug.Print "Subject: " & OutlookItem.Subject
        Debug.Print "Body: " & OutlookItem.Body
    Next
    
    ' Release the objects
    Set OutlookItem = Nothing
    Set OutlookFolder = Nothing
    Set OutlookNamespace = Nothing
    Set OutlookApp = Nothing
End Sub

Sub CountInboxFolders()
    Dim OutlookApp As Object
    Dim OutlookNamespace As Object
    Dim Folder As Object
    Dim InboxCount As Integer
    Dim FolderType As Integer

    ' Create an Outlook application instance
    Set OutlookApp = CreateObject("Outlook.Application")

    ' Get the MAPI namespace
    Set OutlookNamespace = OutlookApp.GetNamespace("MAPI")

    ' Initialize the inbox count
    InboxCount = 0

    ' Loop through all folders
    For Each Folder In OutlookNamespace.Folders
        ' Check if the folder is an inbox folder (6 corresponds to the inbox folder)
        FolderType = Folder.DefaultItemType
        If FolderType = 6 Then
            InboxCount = InboxCount + 1
        End If
    Next

    ' Display the count of inbox folders
    MsgBox "The user has " & InboxCount & " inbox folder(s)."

    ' Release the objects
    Set Folder = Nothing
    Set OutlookNamespace = Nothing
    Set OutlookApp = Nothing
End Sub
